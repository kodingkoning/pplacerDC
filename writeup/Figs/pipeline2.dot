digraph G {
  rankdir=LR

  // predefine nodes
  randomClade1[label="random clade T1"]
  randomClade2[label="random clade T2"]
  randomClade3[label="random clade T3"]
  pplacer1[label="place q in T1"]
  pplacer2[label="place q in T2"]
  pplacer3[label="place q in T3"]
  place1[label="construct T1'"]
  place2[label="construct T2'"]
  place3[label="construct T3'"]
  raxml1[label="score T1'"]
  raxml2[label="score T2'"]
  raxml3[label="score T3'"]
  raxmlapples[label="score Tapples"]
  return[label="return best tree"]
  apples[label="apples"]

	subgraph cluster_0 {
		style=filled;
		color=lightgrey;
		node [style=filled,color=white];
		randomClade1 -> pplacer1 -> place1 -> raxml1;
		randomClade2 -> pplacer2 -> place2 -> raxml2;
		randomClade3 -> pplacer3 -> place3 -> raxml3;
    raxmlapples
		label = "Parallel loop over (random) clases of Tapples with the placement (placement removed)";
	}
  subgraph cluster_1 {
		//style=filled;
		color=blue;
		node [style=filled,color=white];
    apples
		label = "Run parallel APPLES";
  }

	start -> apples;
  apples -> randomClade1;
  apples -> randomClade2;
  apples -> randomClade3;
  apples -> raxmlapples;
  raxml1 -> return;
  raxml2 -> return;
  raxml3 -> return;
  raxmlapples -> return;
  return -> end;

	start [shape=Mdiamond];
	end [shape=Msquare];
}
